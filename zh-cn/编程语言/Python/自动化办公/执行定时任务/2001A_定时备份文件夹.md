# 文章名
## 本章要点
1. 要点一
1. 要点
1. 要点
1. **要点**


## 学习目标

1. 。


## 思考

## 

实现文件夹的定时备份功能，需要编写代码的组件主要是 **Worker** 组件和 **Beat** 组件。

**Worker** 组件是**真正执行计划任务的组件**，它**执行的计划任务对象是一个函数**，因此可以把备份功能封装成函数，由 Worker 组件按照存储 Redis 中的时间进行定时备份。


**Beat** 组件编写的代码**主要是任务的执行时间和该时间运行的任务名称**。

而其他两个组件中的 **Broker** 承担的是**Beat 和 Worker 之间的调度工作**，即**接收 Beat 发送的任务**，和**等待 Worker 来取任务**，因此它和存储定时任务的 Backend 组件不需要进行编程。


那接下来，我们将编写定时运行任务的代码和 Worker、Beat 两个组件进行整合，来实现完整的 Celery 定时任务。


定时运行任务的代码保护了**两部分功能**，分别是**设置 Celery 的定时任务日期**，以及**编写要运行的定时任务函数**。我们首先来看一下如何设置定时任务的日期。

## 设置定时任务的日期

定时任务的日期，是由指定**任务名称**、**任务要执行的函数名称**、**执行时间**和**执行函数**的参数四个部分组成的嵌套字典类型。

任务名称作为字典的“**key**”，其他三个部分作为字典的值，并分别以“**task**”、“**schedule**”、“**args**”作为内部字典的“**key**”。


每周六 22 点 01 分执行 test1.py 文件的 run1() 函数编写定时任务，那么嵌套字典应该为如下格式：


```python

from celery.schedules import crontab

"任务名称": {
    "task": "任务要执行的函数名称",  
    "schedule": crontab(minute=分钟, hour=24小时制, day_of_week=一周的第几天),
    "args": ()
}
```


```python

 from celery.schedules import crontab
   "test1": {
        "task": "tasks.jobs.test1.run1",  #执行的函数
        "schedule": crontab(minute=1, hour=22, day_of_week=6),
        "args": ()
    }

```

详细解释一下三个字典的 value 值。首先，task 字典的值"tasks.jobs.test1.run1"中的“tasks.jobs”是指 **tasks 文件夹下的 jobs 文件夹**，tasks 文件夹用来存放定时任务的脚本文件，jobs 文件夹用于存放要执行的 python 脚本文件。


你肯定会问，为什么要使用这么多不同的文件夹呢？原因就在于，使用不同的文件夹有助于区分不同组件的功能。像“test1.run1”表示 jobs 文件夹下的 test1.py 文件中的 run1 函数，而这个函数就是 Celery 的 Worker 组件将要执行的定时任务。

其次，“schedule”字典的值“value”表示任务“test1”将会在何时运行。它的参数是一个 crontab 函数。该函数定义如下：

```python
crontab(
    minute='*', 
    hour='*', 
    day_of_week='*',
    day_of_month='*', 
    month_of_year='*'
)
```

crontab() 函数的参数，就是用来灵活配置定时任务的执行时间的。我以 minute 来为你举例，它可以有四种写法：如果 minute 为默认的“*”，表示每分钟执行一次。如果 minute 为具体的数字，例如 10，表示将会在第 10 分钟运行任务。不过这里要注意的是，当你使用具体数字时需要配合其他参数一起生效。假设小时的参数为“*”，则表示每小时的第 10 分钟运行任务，假设小时的参数为 5，则表示 5 点 10 分运行任务。如果 minute 参数为“*/2” ，表示每 2 分钟运行一次任务。如果 minute 参数为“1，3，5”，表示每小时第 1、3、5 分钟运行一次任务。四种写法也同样可以应用于参数 hour(小时)、day_of_week(星期)、day_of_month(月)、month_of_year(年)，因此其他位置的参数我就不再一一为你进行讲解了。最后一个参数是 args，它的参数是元组， 用来指定定时运行任务时，为该任务对应的函数传递哪些参数，如果不需要传递参数，则需要保留该值为空元组“()”格式。设置好定时任务的日期之后，需要继续编写该日期所需要运行的任务函数。定时运行的任务函数需要按照“task”的字典 value 保存在“tasks.jobs”目录中，我把目录结构的截图放在下方，帮你更直观地找到每个功能所在的文件目录。


## 总结
- 总结一
- 总结二
- 总结三
https://github.com/Wechat-ggGitHub/Awesome-GitHub-Repo

[项目演示地址](https://github.com/testeru-pro/junit5-demo/tree/main/junit5-basic)


# 学习反馈

1. SpringBoot项目的父工程为( )。

   - [x] A. `spring-boot-starter-parent`
   - [ ] B.`spring-boot-starter-web`
   - [ ] C. `spring-boot-starter-father`
   - [ ] D. `spring-boot-starter-super`


<style>
  strong {
    color: #ea6010;
    font-weight: bolder;
  }
  .reveal blockquote {
    font-style: unset;
  }
</style>


