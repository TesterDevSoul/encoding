---
theme: "league"
transition: "fade"
highlightTheme: "monokai"
slideNumber: false
title: "霍格沃兹测试开发"
use: hogwarts
---

# 性能实战

霍格沃兹测试开发学社

ceshiren.com

---

## 目录





---


## JMeter介绍

```plantuml
@startmindmap
scale 10
title JMeter主要特性
* JMeter主要特性
** 开源免费
** 支持多种协议，如 HTTP、TCP、JDBC...
** 支持多种数据格式，如 json、xml...
** GUI 和 命令行两种操作方式'

left side

** 支持分布式测试
** 内置组件丰富
** 支持插件和扩展
** 多种输出格式
** 跨平台支持，Widow、Mac、Centos...
@endmindmap
```




---


## JMeter安装

```plantuml
@startmindmap
scale 10
title JMeter安装
* JMeter安装
** 环境准备
*** Java环境准备
** 压缩包解压安装
*** Mac系统
*** Window系统
*** Linux系统
** 环境验证
*** Java环境验证
**** java -version 
**** javac
*** JMeter环境验证
**** jmeter -v
@endmindmap
```



---






## JMeter启动提示

```bash
# 不要使用GUI模式进行负载测试 GUI模式只是压测脚本的创建和调试
Dont use GUI mode for load testing !, only for Test creation and Test debugging.
# 如果想要进行负载测试 使用CLI模式 即非GUI模式 -- 静默压测会详细介绍
For load testing, use CLI Mode (was NON GUI):
   jmeter -n -t [jmx file] -l [results file] -e -o [Path to web report folder]
# 可以增加Java的堆来满足压测需求
& increase Java Heap to meet your test requirements:
# 修改JMeter文件的Java堆变量
   Modify current env variable HEAP="-Xms1g -Xmx1g -XX:MaxMetaspaceSize=256m" in the jmeter batch file
```



---


## 压测脚本四要素

```plantuml
@startmindmap
scale 10
title 测试计划
* 测试计划四要素
** 一个JMeter脚本中测试计划只有一个
** 测试计划中至少有一个线程组
** 至少有一个取样器
** 至少有一个监听器
@endmindmap
```


---


### 用户定义的变量

```plantuml
@startmindmap
scale 10
title 用户定义的变量
* 用户定义的变量
** 声明
*** Name = Value
** 引用
*** ${变量名Name}
** 作用
*** 重复使用不同取样器和控制器中的常量或动态值
** 应用场景
*** 设置公共参数
*** 动态生成数据
*** 参数化测试数据
@endmindmap
```



---

## 线程组件

```plantuml
@startmindmap
scale 10
title 线程组件
* 线程组件
** SetUp线程组
*** 主线程组之前运行
*** 设置测试环境
**** 加载测试数据
**** 提交测试配置
** 主线程组
*** 测试计划的主要部分
*** 模拟的用户行为
**** 发出HTTP请求
**** 访问数据库
** TearDown线程组
*** 主线程组之后运行
*** 用于清理测试环境
**** 删除测试数据
**** 恢复初始设置
**** 对测试结果执行一些额外的校验操作
@endmindmap
```




---

## 线程组添加

添加线程组，**测试计划**(`Test Plan`) -> **添加**(`Add`) -> **线程**(`Threads`) -> **线程组**(`Thread Group`)

![](assets/20230107092806.png)




---


## 线程组参数

```plantuml
@startmindmap
scale 10
title 主线程组
* 主线程组
** 在取样器错误后要执行的动作
*** 继续
**** HTTP1->HTTP2Error->HTTP3->HTTP1->HTTP2Error->HTTP3
*** 启动下一进程循环
**** HTTP1->HTTP2Error->HTTP1->HTTP2Error
*** 停止线程
**** 退出该线程，不影响当前测试计划下其他的线程组
*** 停止测试
**** 请求发送完成并获得对应结果后，停止测试
*** 立即停止测试
**** 请求发送完成，不会等着请求完全响应成功后再停止
** 线程属性
*** 线程数
**** 并发用户数，同时操作应用程序的虚拟用户数
*** Ramp-up时间（秒）
**** 在时间内把请求发送出去
*** 循环次数
**** 上面设置的线程数，执行的次数
*** 延迟创建线程直到需要
**** 当线程需要执行的时候，才会被创建
*** 持续时间（秒）
**** 执行N秒后结束
*** 启动延迟（秒）
**** 开始执行，延迟N秒后才发送请求
@endmindmap
```




---




