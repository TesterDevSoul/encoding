## 添加附件

Allure2报告中可以添加附件来丰富测试报告内容，例如测试数据文件、日志文件、截图等等。添加附件可以使报告更加详尽，有助于对测试结果进行分析和调试。

### 添加方式

在Allure2中，添加附件有以下两种方式：

#### 使用@Attachment注解

可以使用@Attachment注解将文件内容添加为附件，并指定其类型和名称，如下所示：

```java
@Attachment(value = "Page screenshot", type = "image/png")
public byte[] attachScreenshot() {
    return ((TakesScreenshot)driver).getScreenshotAs(OutputType.BYTES);
}
```
上述代码将以“Page screenshot”为名称，将截图文件添加为PNG类型的附件。

#### 使用Allure.addAttachment()方法

也可以使用Allure.addAttachment方法手动添加附件，如下所示：

```java
Allure.addAttachment("test-data", "text/plain", "testdata.txt", testData.getBytes());
```


上述代码将以“test-data”为名称，将testdata.txt文件添加为文本类型的附件，并将其内容设置为testData字符串。

无论使用哪种方式，添加的附件都将出现在Allure2报告中，并且可以在报告中查看或下载。


### 注解方式添加

#### 语法结构

`@Attachment`注解是用来在Allure报告中添加附件的注解，其语法结构如下：


```java
@Attachment(value = "附件名称", type = "附件类型", fileExtension = "附件后缀名")
public byte[] methodName() {
    // 方法体
}

```

- `value`：附件**名称**，必填参数。

- `type`：附件**类型**，可以是`text/plain`、`image/png`、`image/jpeg`等，不填**默认为`text/plain`**。

- `fileExtension`：附件文件**后缀名**，不填**默认为空字符串**。


需要注意的是，方法的返回值必须是**字节数组类型**，如果方法的返回值不是字节数组类型，`Allure`会在报告中显示错误信息。

同时，方法的**访问修饰符**必须是`public`，否则`Allure`也会在报告中显示错误信息。



#### 示例代码

```java
//添加的为空文本
@Attachment(value = "text文本添加", type = "text/plain")
@DisplayName("注解 - 文本添加验证")
@Test
public void testText() {
    System.out.println("注解的文本添加");
}
```

### 调用方法添加

#### 语法结构

```java
public static void addAttachment(String name, String type, InputStream stream, String... testNames){

}

```

- `name`：附件名称。
- `type`：附件类型，如 `image/png`、`text/plain` 等。
- `stream`：附件数据流。
- `testNames`：可选参数，指定添加附件的测试用例名称，只有这些测试用例失败时才会显示该附件。


注意⚠️：使用该方法添加的附件仅在 `Allure` 报告中显示，不会影响测试用例本身的执行。







