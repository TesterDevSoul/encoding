<style>
  strong {
    color: #ea6010;
    font-weight: bolder;
  }
  .reveal blockquote {
    font-style: unset;
  }
</style>

#  一」 App 自动化测试的价值与体系


## App 测试的时代背景

- **移动应用的兴起**：随着智能手机和移动应用的普及，移动应用成为人们日常生活和工作的重要组成部分。移动应用的数量和复杂性迅速增长，需要进行全面的测试以确保其质量和稳定性。



- **产品发布周期**：按月发布 -> 按周发布 -> 按小时发布。

    >**快速迭代和发布周期**：移动应用的开发和发布周期通常很短，需要快速迭代和持续交付。这要求测试团队能够及时进行测试，并提供及时的反馈和修复。自动化测试和持续集成成为应对快速迭代的关键。

- **多端发布**：Android、iOS、微信小程序、h5。

- **多机型发布**：众多设备型号、众多系统版本。
    >**多平台和多设备环境**：移动应用需要在多种操作系统（如iOS、Android）和多种设备（如手机、平板电脑）上运行。这增加了测试的复杂性，需要测试团队能够覆盖各种平台和设备组合进行全面测试。

- **多环境发布**：联调环境、测试环境、预发布环境、线上环境。

- **多版本共存**：用户群体中存在多个不同的版本。

- **历史回归测试任务**：成百上千条业务用例如何回归。


**用户体验的重要性**：移动应用的成功与用户体验密切相关。用户对应用的期望越来越高，对性能、响应速度、界面友好性等方面的要求也越来越高。因此，移动应用测试需要关注用户体验，确保应用在各种情况下都能提供良好的用户体验。

综上所述，移动应用的普及、多平台和多设备环境、用户体验的重要性、快速迭代和发布周期、跨功能和跨团队合作以及安全性和隐私保护等因素，共同推动了 App 测试的时代背景。测试团队需要适应这些变化，并采用适当的测试策略和工具来应对不断变化的测试需求。


## UI 自动化价值

以下是 UI 自动化测试价值 一些主要方面：

- **提高测试效率**：UI 自动化测试可以替代手动测试过程，大大提高测试效率。通过编写自动化测试脚本，可以自动执行大量的测试用例，覆盖广泛的功能和场景，快速发现潜在的问题。

- **提高测试覆盖率**：自动化测试可以更全面地覆盖应用的用户界面和交互操作。它可以模拟用户的真实操作，测试应用的各个功能和流程。这样可以发现更多的潜在问题，并确保应用在各种情况下的稳定性和一致性。

- **提高测试质量**：自动化测试可以减少人为的错误和遗漏，通过可重复执行的测试流程，保证了一致性和准确性。它可以捕捉到一些细微的问题和边界情况，从而提高应用的质量。比如：**兼容性测试**、**自动化探索测试**等等。

- **节省人力成本**：相对于手动测试，UI 自动化测试可以节省大量的人力资源。一旦编写了自动化测试脚本，就可以重复执行测试，不再需要人工逐个执行测试用例。这样，测试团队可以将更多的精力投入到其他更有价值的任务上。

- **提升开发效率**：UI 自动化测试可以与持续集成和持续交付流程集成，作为开发流程的一部分运行。它可以在每次代码提交后自动执行测试，及早发现问题，减少开发周期，提高开发效率。

- **多平台和多设备支持**：UI 自动化测试可以在不同的操作系统和设备上运行，确保应用在各种平台和设备上的一致性和兼容性。这对于移动应用开发和跨平台应用非常重要。

- **可视化反馈和报告**：UI 自动化测试通常提供可视化的测试结果和报告，可以清晰地展示测试覆盖率、通过的测试用例和失败的测试用例。这样可以更好地跟踪测试进度和问题，便于团队合作和决策。


## 自动化测试的意义

帮助业务以更好的品质更快的占位市场。

- 更高的测试覆盖率。

- 配合DevOps 持续集成，快速响应版本。

- 专项测试融合其中：适配、性能、弱网。


## 如何做自动化测试？

- 第一步，做业务测试平台；
  >比如：腾讯内部先做微信、王者荣耀、腾讯视频等等app产品的业务测试平台。

- 第二步，做统一自动化测试平台。
  >统一自动化测试平台有：兼容适配测试、云真机测试、耗电量测试、功能测试。

![](assets/20230512152520.png)


**一个好的自动化测试平台需要帮助业务解决哪些问题？**

1. **效率**：业务接入更加方便、快捷，支持多种接入方式。
2. **可用**：测试任务执行更加稳定，支持99.9%。
3. **效果**：问题分析定位方便，更容易回归。

# 二」Appium


## Appium 介绍

Appium是一款**开源**的自动化测试框架，专门用于移动应用程序的自动化测试。它可以**跨平台**测试iOS和Android应用程序，支持**多种编程语言**和测试框架。

它使用 **WebDriver** 协议驱动 iOS、Android 和 Windows 应用程序。

![](assets/appium-logo.png)

## Appium 特点和功能

>推荐 Appium 原因。


以下是Appium的主要特点和功能：

#### 跨平台支持

Appium可以同时测试iOS和Android应用程序，无需修改测试脚本或重新编译应用程序。这使得测试团队能够使用统一的工具和流程来测试不同平台的应用程序。

#### 多种编程语言支持

Appium支持多种编程语言，包括Java、Python、JavaScript、Ruby和C#等。

这使得测试人员可以使用他们熟悉的编程语言编写测试脚本，降低了学习成本。

#### 支持多种测试框架

Appium可以与各种测试框架集成，如JUnit、TestNG、RSpec和NUnit等。

这使得测试团队可以根据自己的需求选择适合的测试框架进行测试。

#### 支持真机和模拟器

Appium可以同时测试真机和模拟器上的应用程序。

测试人员可以在真实设备上进行测试以验证应用程序的真实性能和兼容性，也可以在模拟器上进行快速测试。

#### 基于WebDriver协议

Appium使用WebDriver协议来与设备进行通信。

这意味着测试人员可以使用标准的WebDriver API来编写测试脚本，与Web应用程序测试相似，易于使用和学习。

#### 对原生和混合应用的支持

Appium支持测试原生应用和混合应用。

无论应用程序是完全原生的还是包含Web视图，测试人员都可以使用Appium来自动化测试各种类型的应用程序。

#### 灵活的定位策略

Appium提供了多种元素定位策略，包括ID、类名、XPath和CSS选择器等。

这使得测试人员可以根据需要选择适合的定位策略来查找和操作应用程序中的元素。

#### 底层多引擎切换

#### 生态丰富，开源和活跃的社区

[Appium](http://appium.io/docs/en/2.0/)是开源的，具有庞大而活跃的社区支持，可以获取广泛的文档、教程和问题[issue](https://github.com/appium/appium/issues)解答，同时可以参与贡献和改进框架。



#### 并行执行

Appium支持并行执行测试，可以同时在多个设备上或多个模拟器上运行测试，提高测试效率。

#### 可扩展性

Appium可以与其他测试框架和工具集成，如JUnit、TestNG和Cucumber等，方便测试团队根据自己的需求扩展测试功能。



总的来说，Appium具有跨平台支持、多语言支持、基于WebDriver协议、支持原生和混合应用、真实设备和模拟器支持、并行执行、可扩展性和活跃的社区等主要特点。这些特点使得Appium成为广受欢迎的移动应用自动化测试框架。


![](assets/appium_principle1.png)

## Appium 组件图

![](assets/2022-08-17-19-42-14.png)


## 环境准备


- **Android Studio**：SDK、Emulator
- **模拟器**： 网易 mumu、Android Emulator、真机「建议」
- **被测 App**：企业微信
- **Appium Server**：GUI 版本、CMD 版本
- **Appium Inspector**：界面分析 测试用例生成


## 获取 App 信息

### App 入口

App 入口，三种方式获取：

#### 1. 通过 monkey 获取

```bash
# 设备的系统版本 安卓手机的系统版本，非小米、华为系统版本号 

adb shell getprop ro.build.version.release

#第三方app的包名   mm wework
adb shell pm list packages -3 

# 启动的app的页面
adb shell monkey -p com.tencent.wework -vvv 1

```

![](assets/20230512170632.png)

![](assets/20230512170616.png)

#### 2. 通过 logcat 日志获取

```bash
# Mac/Linux
adb logcat ActivityManager:I | grep "cmp"

# Windows 
adb logcat ActivityManager:I | findstr "cmp"
```

![](assets/20230512160633.png)

#### 3. 通过 aapt 获取

必须有手机root用户。

- **环境变量**：

```bash
export ANDROID_HOME=/Users/gaigai/sdk

export PATH=$PATH:${ANDROID_HOME}/emulator:${ANDROID_HOME}/platform-tools:${ANDROID_HOME}/tools:${ANDROID_HOME}/tools/bin:${ANDROID_HOME}/build-tools/31.0.0/
```

```bash
# 安装，配置环境变量{ANDROID_HOME}/build-tools/{version}/
sdkmanager build-tools

#获取第三方app的包名
adb shell pm list packages -3 

# 查看设备上安装的所有应用程序的包名及其对应的 APK 文件路径
adb shell pm list packages -f

```

![](assets/20230512165551.png)



```bash
# Mac/Linux 
aapt dump badging wework.apk | grep launchable-activity

# Windows 
aapt dump badging wework.apk | findstr launchable-activity
```

用于获取 Android 应用程序信息的命令，它可以解析 APK 文件并提取应用程序的各种信息。

在使用 aapt dump badging 命令时，需要提供要分析的 APK 文件的路径。



### 启动应用验证

```bash
adb shell am start -W -n <package-name>/<activity-name> -S
```

- **am**： Android 中的 Activity Manager（活动管理器）的缩写，启动一个应用程序的活动（Activity）。

- **-W**：在启动应用程序后，等待应用程序完全启动并返回启动信息。

- **-n \<package-name> \<activity-name>**：指定要启动的应用程序的包名和活动名。

- **-S**：输出启动的时间和状态信息。

执行该命令后，adb 将启动应用程序，并输出应用程序启动时间和状态信息。



```bash
adb shell am start -W -n com.tencent.wework/.launch.LaunchSplashActivity -S
```

![](assets/20230512163337.png)




## 配置待测应用

- `platformName`：平台，Android/iOS
- `deviceName`：设备名
- `appPackage`：应用的包名
- `appActivity`：应用的页面名 Activity
- `noReset`: 防止清空缓存信息

![](assets/desire_config.png)

---

## Appium inspector 页面结构

![](assets/page_frame.png)


# 参考链接
https://testerhome.com/topics/30789